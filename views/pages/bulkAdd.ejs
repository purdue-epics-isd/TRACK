<!DOCTYPE html>
<html>

<head>
  <title>Bulk Add</title>
  <link rel="stylesheet" href="/css/global.css">
  <link rel="stylesheet" href="/css/goal.css">
  <script src="./studentCreator.js" type="module"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
</head>

<div class="grid-container">

  <%- include("navbar.ejs")%>

    <main class="main">

      <script>
        const currentTheme = localStorage.getItem('theme');
        if (currentTheme) {
          document.documentElement.setAttribute('data-theme', currentTheme);
          localStorage.setItem('theme', currentTheme);
        }
      </script>

      <!-- This form allows an ISD admin to submit and excel file to add student, teacher, and goal data in bulk -->
      <form action="/bulkadd" method="post">
        <h2>Bulk Add</h2>
        <input type="file" name="excel" id="excel" class="file" accept=".csv" onChange="changeArr()">
        <input type="hidden" name="arr" id="arr">
        <input type="submit" class="submit" name="submit">
      </form>

      <script>
        function changeArr() {
          var table = []
          console.log("addStudents")
          var file = document.getElementById("excel").files[0];
          console.log(file)
          var reader = new FileReader();
          reader.onload = function (file) {
            var content = file.target.result;
            var rows = file.target.result.split(/[\r\n|\n]+/);
            console.log(rows)
            for (let i = 0; i < rows.length; i++) {
              var splitRows = rows[i].split(',');
              console.log(splitRows);
              table.push(splitRows)
            }
            document.getElementById("arr").value = table;
          }
          reader.readAsText(file);
        }

      </script>

    </main>

</div>

</html>